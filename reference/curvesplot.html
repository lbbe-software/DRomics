<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot of fitted curves — curvesplot • DRomics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot of fitted curves — curvesplot"><meta name="description" content="Provides a plot of all the fitted curves from a dataframe of the main workflow
results, possibly extended with
additional information (e.g. groups from functional annotation) used to color and/or split the curves."><meta property="og:description" content="Provides a plot of all the fitted curves from a dataframe of the main workflow
results, possibly extended with
additional information (e.g. groups from functional annotation) used to color and/or split the curves."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DRomics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.6.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DRomics_vignette.html">Overview of the DRomics package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbbe-software/DRomics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot of fitted curves</h1>

      <div class="d-none name"><code>curvesplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides a plot of all the fitted curves from a dataframe of the main workflow
results, possibly extended with
additional information (e.g. groups from functional annotation) used to color and/or split the curves.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">extendedres</span>, <span class="va">xmin</span>, <span class="va">xmax</span>, y0shift <span class="op">=</span> <span class="cn">TRUE</span>, scaling <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       <span class="va">facetby</span>, <span class="va">facetby2</span>, free.y.scales <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">ncol4faceting</span>,</span>
<span>                       <span class="va">colorby</span>, removelegend <span class="op">=</span> <span class="cn">FALSE</span>,  </span>
<span>                        npoints <span class="op">=</span> <span class="fl">500</span>, line.size <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                        line.alpha <span class="op">=</span> <span class="fl">0.8</span>, dose_log_transfo <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       addBMD <span class="op">=</span> <span class="cn">TRUE</span>, BMDtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"zSD"</span>, <span class="st">"xfold"</span><span class="op">)</span>, </span>
<span>                       point.size <span class="op">=</span> <span class="fl">1</span>, point.alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-extendedres">extendedres<a class="anchor" aria-label="anchor" href="#arg-extendedres"></a></dt>
<dd><p>the dataframe of results provided by bmdcalc (res)
 or a subset of this data frame (selected lines). This dataframe can be extended
 with additional columns coming for example from the annotation of items, and some lines
 can be replicated if their corresponding item has more than one annotation.
 This extended dataframe
 must at least contain the column giving the identification of each curve (<code>id</code>),
 the column <code>model</code> naming the fitted model and the values of
the parameters (columns <code>b</code>, <code>c</code>, <code>d</code>, <code>e</code>, <code>f</code>) and
a column coding for the chosen BMD, by default <code>BMD.zSD</code> or <code>BMD.xfold</code>
<code>BMDtype</code> is to <code>"xfold"</code>.</p></dd>


<dt id="arg-xmin">xmin<a class="anchor" aria-label="anchor" href="#arg-xmin"></a></dt>
<dd><p>If not defined, a value just below the maximum BMD values is fixed if the x  dose scale is in log, or 0 otherwise.</p></dd>


<dt id="arg-xmax">xmax<a class="anchor" aria-label="anchor" href="#arg-xmax"></a></dt>
<dd><p>Maximal dose/concentration for definition of the x range (can be defined
 as <code>max(f$omicdata$dose)</code> with <code>f</code> the output of <code><a href="drcfit.html">drcfit()</a></code>). If not defined, a value just above the maximum BMD values is taken.</p></dd>


<dt id="arg-y-shift">y0shift<a class="anchor" aria-label="anchor" href="#arg-y-shift"></a></dt>
<dd><p>If <code>TRUE</code> (default choice) curves are all shifted to have the theoretical
 signal at the control at 0.</p></dd>


<dt id="arg-scaling">scaling<a class="anchor" aria-label="anchor" href="#arg-scaling"></a></dt>
<dd><p>If <code>TRUE</code>, default choice, curves are all shifted to have the theoretical
 signal at the control at 0 <code>y0</code> and scaled by dividing by
 the maximal absolute signal change (up or down) from the signal at the control
 <code>maxychange</code>.</p></dd>


<dt id="arg-facetby">facetby<a class="anchor" aria-label="anchor" href="#arg-facetby"></a></dt>
<dd><p>optional argument naming the column of <code>extendedres</code> chosen
  to split the plot in facets (no split if omitted).</p></dd>


<dt id="arg-facetby-">facetby2<a class="anchor" aria-label="anchor" href="#arg-facetby-"></a></dt>
<dd><p>optional argument naming the column of <code>extendedres</code> chosen
  as an additional argument to split the plot in facets using
  <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">ggplot2::facet_grid</a></code>, with columns defined by <code>facetby</code>
  and rows defined by <code>facetby2</code> (no split if omitted).</p></dd>


<dt id="arg-free-y-scales">free.y.scales<a class="anchor" aria-label="anchor" href="#arg-free-y-scales"></a></dt>
<dd><p>if TRUE the y scales are free in the different facets.</p></dd>


<dt id="arg-ncol-faceting">ncol4faceting<a class="anchor" aria-label="anchor" href="#arg-ncol-faceting"></a></dt>
<dd><p>Number of columns for facetting (not used if <code>facetby2</code>
  is also provided.</p></dd>


<dt id="arg-colorby">colorby<a class="anchor" aria-label="anchor" href="#arg-colorby"></a></dt>
<dd><p>optional argument naming the column of <code>extendedres</code> chosen
  to color the curves (no color if omitted).</p></dd>


<dt id="arg-removelegend">removelegend<a class="anchor" aria-label="anchor" href="#arg-removelegend"></a></dt>
<dd><p>If <code>TRUE</code> the color legend is removed (useful if the number
  of colors is great).</p></dd>


<dt id="arg-npoints">npoints<a class="anchor" aria-label="anchor" href="#arg-npoints"></a></dt>
<dd><p>Number of points computed on each curve to plot it.</p></dd>


<dt id="arg-line-size">line.size<a class="anchor" aria-label="anchor" href="#arg-line-size"></a></dt>
<dd><p>Width of the lines for plotting curves.</p></dd>


<dt id="arg-line-alpha">line.alpha<a class="anchor" aria-label="anchor" href="#arg-line-alpha"></a></dt>
<dd><p>Transparency of the lines for plotting curves.</p></dd>


<dt id="arg-dose-log-transfo">dose_log_transfo<a class="anchor" aria-label="anchor" href="#arg-dose-log-transfo"></a></dt>
<dd><p>If TRUE a log transformation of the dose is used in the plot.
  This option needs a definition of a strictly positive value of xmin in input.</p></dd>


<dt id="arg-addbmd">addBMD<a class="anchor" aria-label="anchor" href="#arg-addbmd"></a></dt>
<dd><p>If TRUE points are added on the curve at BMD-BMR values (requires to have
BMD and BMD values in the first argument extendedres).</p></dd>


<dt id="arg-bmdtype">BMDtype<a class="anchor" aria-label="anchor" href="#arg-bmdtype"></a></dt>
<dd><p>The type of BMD to add, <code>"zSD"</code> (default choice) or <code>"xfold"</code>.</p></dd>


<dt id="arg-point-size">point.size<a class="anchor" aria-label="anchor" href="#arg-point-size"></a></dt>
<dd><p>Size of the BMD-BMR points added on the curves.</p></dd>


<dt id="arg-point-alpha">point.alpha<a class="anchor" aria-label="anchor" href="#arg-point-alpha"></a></dt>
<dd><p>Transparency of the BMD-BMR points added on the curves.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each item of the extended dataframe, the name of the model
(column <code>model</code>) and the values of
the parameters (columns <code>b</code>, <code>c</code>, <code>d</code>, <code>e</code>, <code>f</code>)
are used to compute theoretical dose-response curves in the range
<code>[xmin ; xmax].</code></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a ggplot object.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="bmdboot.html">plot.bmdboot</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marie-Laure Delignette-Muller</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) A toy example on a very small subsample of a microarray data set) </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_very_small_sample.txt"</span>, </span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-in"><span><span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing intercept from test coefficients</span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="drcfit.html">drcfit</a></span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitting may be long if the number of selected items is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   6%  |                                                                              |========                                                              |  12%  |                                                                              |============                                                          |  18%  |                                                                              |================                                                      |  24%  |                                                                              |=====================                                                 |  29%  |                                                                              |=========================                                             |  35%  |                                                                              |=============================                                         |  41%  |                                                                              |=================================                                     |  47%  |                                                                              |=====================================                                 |  53%  |                                                                              |=========================================                             |  59%  |                                                                              |=============================================                         |  65%  |                                                                              |=================================================                     |  71%  |                                                                              |======================================================                |  76%  |                                                                              |==========================================================            |  82%  |                                                                              |==============================================================        |  88%  |                                                                              |==================================================================    |  94%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdcalc.html">bmdcalc</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1.a) </span></span></span>
<span class="r-in"><span><span class="co"># Default plot of all the curves with BMD values added as points on the curve</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># use of line size, point size, transparency</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  line.alpha <span class="op">=</span> <span class="fl">0.2</span>, line.size <span class="op">=</span> <span class="fl">1</span>, point.alpha <span class="op">=</span> <span class="fl">0.3</span>, point.size <span class="op">=</span> <span class="fl">1.8</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the same plot with dose not in log scale</span></span></span>
<span class="r-in"><span><span class="co"># fixing xmin and xmax</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmin <span class="op">=</span> <span class="fl">0.1</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  dose_log_transfo <span class="op">=</span> <span class="cn">FALSE</span>, addBMD <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># or not</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, dose_log_transfo <span class="op">=</span> <span class="cn">FALSE</span>, addBMD <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot of curves colored by models</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, colorby <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot of curves facetted by item</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, facetby <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot of curves facetted by trends</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, facetby <span class="op">=</span> <span class="st">"trend"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the same plot with free y scales</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, facetby <span class="op">=</span> <span class="st">"trend"</span>,</span></span>
<span class="r-in"><span>  free.y.scales <span class="op">=</span>  <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># (1.b) </span></span></span>
<span class="r-in"><span><span class="co"># Plot of all the curves without shifting y0 values to 0</span></span></span>
<span class="r-in"><span><span class="co"># and without scaling</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>,  </span></span>
<span class="r-in"><span>  scaling <span class="op">=</span> <span class="cn">FALSE</span>, y0shift <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1.c) </span></span></span>
<span class="r-in"><span><span class="co"># Plot of all the curves colored by model, with one facet per trend</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  facetby <span class="op">=</span> <span class="st">"trend"</span>, colorby <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># changing the number of columns</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  facetby <span class="op">=</span> <span class="st">"trend"</span>, colorby <span class="op">=</span> <span class="st">"model"</span>, ncol4faceting <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># playing with size and transparency of lines</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  facetby <span class="op">=</span> <span class="st">"trend"</span>, colorby <span class="op">=</span> <span class="st">"model"</span>, </span></span>
<span class="r-in"><span>  line.size <span class="op">=</span> <span class="fl">0.5</span>, line.alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>,  </span></span>
<span class="r-in"><span>  facetby <span class="op">=</span> <span class="st">"trend"</span>, colorby <span class="op">=</span> <span class="st">"model"</span>, </span></span>
<span class="r-in"><span>  line.size <span class="op">=</span> <span class="fl">0.8</span>, line.alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>,  </span></span>
<span class="r-in"><span>  facetby <span class="op">=</span> <span class="st">"trend"</span>, line.size <span class="op">=</span> <span class="fl">1</span>, line.alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># (2) an example on a microarray data set (a subsample of a greater data set)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_sample.txt"</span>, package<span class="op">=</span><span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elements of the experimental design in order to check the coding of the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tested doses and number of replicates for each dose:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0  0.69 1.223 2.148 3.774 6.631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5     5     5     5     5     5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of items: 1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "1"    "2"    "3"    "4"    "5.1"  "5.2"  "6.1"  "6.2"  "7.1"  "7.2" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "8.1"  "8.2"  "9.1"  "9.2"  "10.1" "10.2" "11.1" "11.2" "12.1" "12.2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data were normalized between arrays using the following method: cyclicloess </span>
<span class="r-in"><span><span class="op">(</span><span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing intercept from test coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of selected items using a quadratic trend test with an FDR of 0.001: 78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 most responsive items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "384.2" "383.1" "383.2" "384.1" "301.1" "363.1" "300.2" "364.2" "364.1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "363.2" "301.2" "300.1" "351.1" "350.2" "239.1" "240.1" "240.2" "370"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "15"    "350.1"</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="drcfit.html">drcfit</a></span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitting may be long if the number of selected items is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  29%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  79%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of the fitting using the AICc to select the best fit model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 dose-response curves out of 78 previously selected were removed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> because no model could be fitted reliably.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the chosen models among the 67 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Hill           linear      exponential     Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                0               11               30               23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the trends (curve shapes) among the 67 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    U bell  dec  inc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6   20   22   19 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdcalc.html">bmdcalc</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 BMD-xfold values and 0 BMD-zSD values are not defined (coded NaN as </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> the BMR stands outside the range of response values defined by the model).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 BMD-xfold values and 0 BMD-zSD values could not be calculated (coded </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA as the BMR stands within the range of response values defined by the </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model but outside the range of tested doses).</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot split by trend and model with BMR-BMD points added on curves</span></span></span>
<span class="r-in"><span><span class="co"># adding transparency</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  line.alpha <span class="op">=</span> <span class="fl">0.2</span>, line.size <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>  addBMD <span class="op">=</span> <span class="cn">TRUE</span>, point.alpha <span class="op">=</span> <span class="fl">0.2</span>, point.size <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>  facetby <span class="op">=</span> <span class="st">"trend"</span>, facetby2 <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same plot without scaling and not in log dose scale</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">res</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">omicdata</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  line.alpha <span class="op">=</span> <span class="fl">0.2</span>, line.size <span class="op">=</span> <span class="fl">0.8</span>, dose_log_transfo <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  addBMD <span class="op">=</span> <span class="cn">TRUE</span>, point.alpha <span class="op">=</span> <span class="fl">0.2</span>, point.size <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>  scaling <span class="op">=</span> <span class="cn">FALSE</span>, facetby <span class="op">=</span> <span class="st">"trend"</span>, facetby2 <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="curvesplot-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) An example from data published by Larras et al. 2020</span></span></span>
<span class="r-in"><span><span class="co"># in Journal of Hazardous Materials</span></span></span>
<span class="r-in"><span><span class="co"># https://doi.org/10.1016/j.jhazmat.2020.122727</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a dataframe with metabolomic results (output $res of bmdcalc() or bmdboot() functions)</span></span></span>
<span class="r-in"><span><span class="va">resfilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"triclosanSVmetabres.txt"</span>, package<span class="op">=</span><span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">resfilename</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	31 obs. of  27 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ id              : Factor w/ 31 levels "NAP47_51","NAP_2",..: 2 3 4 5 6 7 8 9 10 11 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ irow            : int  2 21 28 34 38 47 49 51 53 67 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ adjpvalue       : num  6.23e-05 1.11e-05 1.03e-05 1.89e-03 4.16e-03 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model           : Factor w/ 4 levels "Gauss-probit",..: 2 3 3 2 2 4 2 2 3 3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ nbpar           : int  3 2 2 3 3 5 3 3 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ b               : num  0.4598 -0.0595 -0.0451 0.6011 0.6721 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ c               : num  NA NA NA NA NA ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ d               : num  5.94 5.39 7.86 6.86 6.21 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ e               : num  -1.648 NA NA -0.321 -0.323 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ f               : num  NA NA NA NA NA ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ SDres           : num  0.126 0.0793 0.052 0.2338 0.2897 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ typology        : Factor w/ 10 levels "E.dec.concave",..: 2 7 7 2 2 9 2 2 7 7 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ trend           : Factor w/ 4 levels "U","bell","dec",..: 3 3 3 3 3 1 3 3 3 3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ y0              : num  5.94 5.39 7.86 6.86 6.21 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ yrange          : num  0.456 0.461 0.35 0.601 0.672 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ maxychange      : num  0.456 0.461 0.35 0.601 0.672 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ xextrem         : num  NA NA NA NA NA ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ yextrem         : num  NA NA NA NA NA ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.zSD         : num  0.528 1.333 1.154 0.158 0.182 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMR.zSD         : num  5.82 5.31 7.81 6.62 5.92 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.xfold       : num  NA NA NA NA 0.832 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMR.xfold       : num  5.35 4.85 7.07 6.17 5.59 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.zSD.lower   : num  0.2001 0.8534 0.7519 0.0554 0.081 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.zSD.upper   : num  1.11 1.746 1.465 0.68 0.794 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.xfold.lower : num  Inf 7.611 Inf 0.561 0.329 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.xfold.upper : num  Inf Inf Inf Inf Inf ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ nboot.successful: int  957 1000 1000 648 620 872 909 565 1000 1000 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a dataframe with annotation of each item identified in the previous file</span></span></span>
<span class="r-in"><span><span class="co"># each item may have more than one annotation (-&gt; more than one line)</span></span></span>
<span class="r-in"><span><span class="va">annotfilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"triclosanSVmetabannot.txt"</span>, package<span class="op">=</span><span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">annotfilename</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	84 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ metab.code: Factor w/ 31 levels "NAP47_51","NAP_2",..: 2 3 4 4 4 4 5 6 7 8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ path_class: Factor w/ 9 levels "Amino acid metabolism",..: 5 3 3 2 6 8 5 5 5 5 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Merging of both previous dataframes</span></span></span>
<span class="r-in"><span><span class="co"># in order to obtain an extenderes dataframe</span></span></span>
<span class="r-in"><span><span class="co"># bootstrap results and annotation</span></span></span>
<span class="r-in"><span><span class="va">extendedres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">res</span>, y <span class="op">=</span> <span class="va">annot</span>, by.x <span class="op">=</span> <span class="st">"id"</span>, by.y <span class="op">=</span> <span class="st">"metab.code"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">extendedres</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         id irow    adjpvalue       model nbpar           b  c        d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 NAP47_51   46 7.158246e-04      linear     2 -0.05600559 NA 7.343571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    NAP_2    2 6.232579e-05 exponential     3  0.45981242 NA 5.941896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   NAP_23   21 1.106958e-05      linear     2 -0.05946618 NA 5.387252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   NAP_30   28 1.028343e-05      linear     2 -0.04507832 NA 7.859109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   NAP_30   28 1.028343e-05      linear     2 -0.04507832 NA 7.859109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   NAP_30   28 1.028343e-05      linear     2 -0.04507832 NA 7.859109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           e  f      SDres     typology trend       y0    yrange maxychange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        NA NA 0.12454183        L.dec   dec 7.343571 0.4346034  0.4346034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -1.647958 NA 0.12604568 E.dec.convex   dec 5.941896 0.4556672  0.4556672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        NA NA 0.07929266        L.dec   dec 5.387252 0.4614576  0.4614576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        NA NA 0.05203245        L.dec   dec 7.859109 0.3498078  0.3498078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        NA NA 0.05203245        L.dec   dec 7.859109 0.3498078  0.3498078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        NA NA 0.05203245        L.dec   dec 7.859109 0.3498078  0.3498078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   xextrem yextrem   BMD.zSD  BMR.zSD BMD.xfold BMR.xfold BMD.zSD.lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA      NA 2.2237393 7.219029        NA  6.609214     0.9785095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA      NA 0.5279668 5.815850        NA  5.347706     0.2000881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      NA      NA 1.3334076 5.307960        NA  4.848527     0.8533711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      NA      NA 1.1542677 7.807077        NA  7.073198     0.7518588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      NA      NA 1.1542677 7.807077        NA  7.073198     0.7518588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      NA      NA 1.1542677 7.807077        NA  7.073198     0.7518588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   BMD.zSD.upper BMD.xfold.lower BMD.xfold.upper nboot.successful</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      4.068699             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1.109559             Inf             Inf              957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1.746010        7.610936             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1.464998             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1.464998             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1.464998             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    path_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                            Lipid metabolism</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                            Lipid metabolism</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                     Carbohydrate metabolism</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                     Carbohydrate metabolism</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Biosynthesis of other secondary metabolites</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                          Membrane transport</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of the dose-response curves by pathway colored by trend</span></span></span>
<span class="r-in"><span><span class="co"># with BMR-BMD points added on curves</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">extendedres</span>, facetby <span class="op">=</span> <span class="st">"path_class"</span>, npoints <span class="op">=</span> <span class="fl">100</span>, line.size <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  colorby <span class="op">=</span> <span class="st">"trend"</span>, xmax <span class="op">=</span> <span class="fl">7</span>, addBMD <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="curvesplot-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same plot not in log scale</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">extendedres</span>, facetby <span class="op">=</span> <span class="st">"path_class"</span>, npoints <span class="op">=</span> <span class="fl">100</span>, line.size <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  dose_log_transfo <span class="op">=</span> <span class="cn">FALSE</span>, colorby <span class="op">=</span> <span class="st">"trend"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="curvesplot-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same plot in log scale without scaling</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">extendedres</span>, facetby <span class="op">=</span> <span class="st">"path_class"</span>, npoints <span class="op">=</span> <span class="fl">100</span>, line.size <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  colorby <span class="op">=</span> <span class="st">"trend"</span>, scaling <span class="op">=</span> <span class="cn">FALSE</span>, xmax <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="curvesplot-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of the dose-response curves split by pathway and by trend</span></span></span>
<span class="r-in"><span><span class="co"># for a selection pathway</span></span></span>
<span class="r-in"><span><span class="va">chosen_path_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Membrane transport"</span>, <span class="st">"Lipid metabolism"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ischosen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">is.element</a></span><span class="op">(</span><span class="va">extendedres</span><span class="op">$</span><span class="va">path_class</span>, <span class="va">chosen_path_class</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">extendedres</span><span class="op">[</span><span class="va">ischosen</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  facetby <span class="op">=</span> <span class="st">"trend"</span>, facetby2 <span class="op">=</span> <span class="st">"path_class"</span>,</span></span>
<span class="r-in"><span>  npoints <span class="op">=</span> <span class="fl">100</span>, line.size <span class="op">=</span> <span class="fl">0.5</span>, xmax <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="curvesplot-20.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of the dose-response curves for a specific pathway</span></span></span>
<span class="r-in"><span><span class="co"># in this example the "lipid metabolism" pathclass</span></span></span>
<span class="r-in"><span><span class="va">LMres</span> <span class="op">&lt;-</span> <span class="va">extendedres</span><span class="op">[</span><span class="va">extendedres</span><span class="op">$</span><span class="va">path_class</span> <span class="op">==</span> <span class="st">"Lipid metabolism"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">curvesplot</span><span class="op">(</span><span class="va">LMres</span>, facetby <span class="op">=</span> <span class="st">"id"</span>, npoints <span class="op">=</span> <span class="fl">100</span>, line.size <span class="op">=</span> <span class="fl">0.8</span>, point.size <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  colorby <span class="op">=</span> <span class="st">"trend"</span>, xmax <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="curvesplot-21.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marie-Laure Delignette-Muller, Elise Billoir, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

