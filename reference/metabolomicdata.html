<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Import and check of continuous omic data (e.g. metabolomic data) — continuousomicdata • DRomics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import and check of continuous omic data (e.g. metabolomic data) — continuousomicdata"><meta name="description" content="Metabolomic or other continuous omics data are imported from a .txt file
(internally imported using the function read.table)
and checked or from a R object of class data.frame
(see the description
of argument file for the required format
of data).
No normalization nor transformation is provided in this function.
The pretreatment of such continuous omic data data must be done before importation of data,
and data must be imported in log scale if needed (imperative for example for metabolomic data),
so that they can be directly modelled using a normal
error model. This strong hypothesis is required both for selection of items and for dose-reponse modelling.
As an example, a basic procedure for this pre-treatment of metabolomic data could follow
the three steps described thereafter:
i) removing of metabolites for which the proportion of missing data
  (non detections) across all the samples is too high
  (more than 20 to 50 percents according to your tolerance level);
ii) retrieving of missing values data using half minimum method
  (i.e. half of the minimum value found for a metabolite across all samples);
iii) log-transformation of values.
If a scaling to the total intensity (normalization by sum of signals
in each sample) or another normalization is necessary and pertinent,
we recommend to do it before those three previously decribed steps.

"><meta property="og:description" content="Metabolomic or other continuous omics data are imported from a .txt file
(internally imported using the function read.table)
and checked or from a R object of class data.frame
(see the description
of argument file for the required format
of data).
No normalization nor transformation is provided in this function.
The pretreatment of such continuous omic data data must be done before importation of data,
and data must be imported in log scale if needed (imperative for example for metabolomic data),
so that they can be directly modelled using a normal
error model. This strong hypothesis is required both for selection of items and for dose-reponse modelling.
As an example, a basic procedure for this pre-treatment of metabolomic data could follow
the three steps described thereafter:
i) removing of metabolites for which the proportion of missing data
  (non detections) across all the samples is too high
  (more than 20 to 50 percents according to your tolerance level);
ii) retrieving of missing values data using half minimum method
  (i.e. half of the minimum value found for a metabolite across all samples);
iii) log-transformation of values.
If a scaling to the total intensity (normalization by sum of signals
in each sample) or another normalization is necessary and pertinent,
we recommend to do it before those three previously decribed steps.

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DRomics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.6-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DRomics_vignette.html">Overview of the DRomics package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbbe-software/DRomics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Import and check of continuous omic data (e.g. metabolomic data)</h1>

      <div class="d-none name"><code>metabolomicdata.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Metabolomic or other continuous omics data are imported from a .txt file
(internally imported using the function <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></code>)
and checked or from a R object of class <code>data.frame</code>
(see the description
of argument <code>file</code> for the required format
of data).
No normalization nor transformation is provided in this function.
The pretreatment of such continuous omic data data must be done before importation of data,
and data must be imported in log scale if needed (imperative for example for metabolomic data),
so that they can be directly modelled using a normal
error model. This strong hypothesis is required both for selection of items and for dose-reponse modelling.
As an example, a basic procedure for this pre-treatment of metabolomic data could follow
the three steps described thereafter:
i) removing of metabolites for which the proportion of missing data
  (non detections) across all the samples is too high
  (more than 20 to 50 percents according to your tolerance level);
ii) retrieving of missing values data using half minimum method
  (i.e. half of the minimum value found for a metabolite across all samples);
iii) log-transformation of values.
If a scaling to the total intensity (normalization by sum of signals
in each sample) or another normalization is necessary and pertinent,
we recommend to do it before those three previously decribed steps.</p>


    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">continuousomicdata</span><span class="op">(</span><span class="va">file</span>, <span class="va">backgrounddose</span>, check <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">metabolomicdata</span><span class="op">(</span><span class="va">file</span>, <span class="va">backgrounddose</span>, check <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'continuousomicdata'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'continuousomicdata'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, range4boxplot <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>The name of the .txt file (e.g. <code>"mydata.txt"</code>)
containing one row per item, with the first column corresponding to the identifier of each item,
and the other columns giving the responses
of the item for each replicate at each dose or concentration.
In the first line, after a name for the identifier column, we must have the tested
doses or concentrations in a numeric format for the corresponding replicate
(for example, if there are triplicates for each treatment,
the first line could be "item", 0, 0, 0, 0.1, 0.1, 0.1, etc.).
This file is imported within the function using the function
<code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></code> with its default field separator (sep argument)and
its default decimal separator (dec argument at ".").
Alternatively an R object of class <code>data.frame</code> can be directly given in input,
corresponding to the output
of <code>read.table(file, header = FALSE)</code> on a file described as above. The two
alternatives are illustrated below in examples.</p></dd>



<dt id="arg-backgrounddose">backgrounddose<a class="anchor" aria-label="anchor" href="#arg-backgrounddose"></a></dt>
<dd><p>This argument must be used when there is no dose at zero in the data, to prevent the calculation of the BMD by extrapolation. All doses below  or equal to the value given in backgrounddose will be fixed at 0, so as to be considered at the background level of exposition.</p></dd>



<dt id="arg-check">check<a class="anchor" aria-label="anchor" href="#arg-check"></a></dt>
<dd><p>If TRUE the format of the input file is checked.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>"continuousomicdata"</code>.</p></dd>


<dt id="arg-range-boxplot">range4boxplot<a class="anchor" aria-label="anchor" href="#arg-range-boxplot"></a></dt>
<dd><p>An argument passed to boxplot(), fixed by default at 0
  to prevent the producing of very large plot files due to many outliers.
  Can be put at 1.5 to obtain more classical boxplots.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to print or plot functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function imports the data, checks their format
(see the description
of argument <code>file</code> for the required format
of data) and gives in the <code>print</code> information
that should help the user to check that the coding of data is correct :
the tested doses (or concentrations),
the number of replicates for each dose, the number of items and the identifiers
of the first 20 items.</p>
<p><code>metabolomicdata()</code> is the first name we gave to this function.
We renamed it <code>continuousomicdata</code> (while keeping the first name available)
to offer its use to other
continuous omic data such as proteomics data or RT-QPCR data. Nevertheless
one should take care of the scale in which such data are imported in DRomics.
A transformation may be needed to enable the use of a normal error model
in each step of the DRomics workflow (from selection of items to modelling and
BMD calculation)</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>continuousomicdata()</code> returns an object of class "continuousomicdata",
   a list with 7 components:</p>
<dl><dt>data</dt>
<dd><p>the numeric matrix of responses of each item in each replicate
  (one line per item, one column per replicate)</p></dd>


    <dt>dose</dt>
<dd><p>the numeric vector of the tested doses or concentrations corresponding
    to each column of data</p></dd>


    <dt>item</dt>
<dd><p>the character vector of the identifiers of the items, corresponding to
    each line of data</p></dd>


    <dt>design</dt>
<dd><p>a table with the experimental design (tested doses and number of
    replicates for each dose) for control by the user</p></dd>


    <dt>data.mean</dt>
<dd><p>the numeric matrix of mean responses of each item per dose (mean
    of the corresponding replicates) (one line per item, one column per unique value
    of the dose</p></dd>


    <dt>data.sd</dt>
<dd><p>the numeric matrix of standard deviations of the response of each
   item per dose (sd of the corresponding replicates, NA if no replicate)
   (one line per item, one column per unique value of the dose)</p></dd>


    <dt>containsNA</dt>
<dd><p>TRUE if the data set contains NA values</p></dd>


</dl><p>The print of a <code>continuousomicdata</code> object gives the tested doses (or concentrations)
  and number of replicates for each dose, the number of items, the identifiers
  of the first 20 items (for check of good coding of data) and the normalization method.
   The plot of a <code>continuousomicdata</code> object shows the data distribution for each dose or concentration and replicate.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See  <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></code> the function used to import data, and
    <code><a href="microarraydata.html">microarraydata</a></code>, <code><a href="RNAseqdata.html">RNAseqdata</a></code> and
    <code><a href="continuousanchoringdata.html">continuousanchoringdata</a></code> for other types of data.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marie-Laure Delignette-Muller</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># (1) import and check of metabolomic data </span></span></span>
<span class="r-in"><span><span class="co"># (an example on a subsample of a greater data set given in the package (see ?Scenedesmus))</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"metabolo_sample.txt"</span>, package <span class="op">=</span> <span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">continuousomicdata</span><span class="op">(</span><span class="va">datafilename</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> We recommend you to check that your omic data were correctly pretreated</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> before importation. In particular data (e.g. metabolomic signal) should</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> have been log-transformed, without replacing 0 values by NA values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (consider using the half minimum method instead for example).</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elements of the experimental design in order to check the coding of the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tested doses and number of replicates for each dose:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0 0.69  1.1 1.79 2.92 4.78 7.76 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10    6    2    2    2    6    2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of items: 109 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "P_2"  "P_4"  "P_5"  "P_6"  "P_7"  "P_10" "P_11" "P_12" "P_14" "P_16"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "P_19" "P_21" "P_22" "P_26" "P_32" "P_34" "P_35" "P_36" "P_37" "P_38"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="metabolomicdata-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="PCAdataplot.html">PCAdataplot</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="metabolomicdata-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># if you want to skip the check of data</span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">continuousomicdata</span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If you want to use your own data set just replace datafilename, </span></span></span>
<span class="r-in"><span><span class="co"># the first argument of metabolomicdata(), </span></span></span>
<span class="r-in"><span><span class="co"># by the name of your data file (e.g. "mydata.txt")</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># You should take care that the field separator of this data file is one</span></span></span>
<span class="r-in"><span><span class="co"># of the default field separators recognised by the read.table() function</span></span></span>
<span class="r-in"><span><span class="co"># when it is used with its default field separator (sep argument)</span></span></span>
<span class="r-in"><span><span class="co"># Tabs are recommended.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use of an R object of class data.frame</span></span></span>
<span class="r-in"><span><span class="co"># An example using the complete data set</span></span></span>
<span class="r-in"><span><span class="co"># Scenedesmus_metab (see ?Scenedesmus for details)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Scenedesmus_metab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">continuousomicdata</span><span class="op">(</span><span class="va">Scenedesmus_metab</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> We recommend you to check that your omic data were correctly pretreated</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> before importation. In particular data (e.g. metabolomic signal) should</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> have been log-transformed, without replacing 0 values by NA values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (consider using the half minimum method instead for example).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elements of the experimental design in order to check the coding of the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tested doses and number of replicates for each dose:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0 0.69  1.1 1.79 2.92 4.78 7.76 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6    3    3    3    3    3    3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of items: 224 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "NAP_1"  "NAP_2"  "NAP_3"  "NAP_4"  "NAP_5"  "NAP_6"  "NAP_7"  "NAP_8" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "NAP_9"  "NAP_11" "NAP_13" "NAP_14" "NAP_15" "NAP_16" "NAP_17" "NAP_18"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "NAP_19" "NAP_20" "NAP_21" "NAP_22"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="metabolomicdata-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marie-Laure Delignette-Muller, Elise Billoir, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

