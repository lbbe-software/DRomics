<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Provides an ECDF plot of a variable, with x-error bars for given confidence 
intervals on this variable, possibly partitioned by groups. 
In the context of this package this function is intended to be
used with the BMD as the variable and with groups defined by the user
from functional annotation."><title>ECDF plot of a variable with given confidence intervals on this variable — ecdfplotwithCI • DRomics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ECDF plot of a variable with given confidence intervals on this variable — ecdfplotwithCI"><meta property="og:description" content="Provides an ECDF plot of a variable, with x-error bars for given confidence 
intervals on this variable, possibly partitioned by groups. 
In the context of this package this function is intended to be
used with the BMD as the variable and with groups defined by the user
from functional annotation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DRomics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.5-0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/DRomics_vignette.html">Overview of the DRomics package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aursiber/DRomics/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>ECDF plot of a variable with given confidence intervals on this variable</h1>
      
      <div class="d-none name"><code>ecdfplotwithCI.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides an ECDF plot of a variable, with x-error bars for given confidence 
intervals on this variable, possibly partitioned by groups. 
In the context of this package this function is intended to be
used with the BMD as the variable and with groups defined by the user
from functional annotation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ecdfplotwithCI</span><span class="op">(</span><span class="va">variable</span>, <span class="va">CI.lower</span>, <span class="va">CI.upper</span>, <span class="va">by</span>, CI.col <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>CI.alpha <span class="op">=</span> <span class="fl">1</span>, add.point <span class="op">=</span> <span class="cn">TRUE</span>, point.size <span class="op">=</span> <span class="fl">1</span>, point.type <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>variable</dt>
<dd><p>A numeric vector of the variable to plot. In the context of the package this variable
may be a BMD.</p></dd>


<dt>CI.lower</dt>
<dd><p>A corresponding numeric vector (same length) with the lower bounds of the confidence intervals.</p></dd>


<dt>CI.upper</dt>
<dd><p>A corresponding numeric vector (same length) with the upper bounds of the confidence intervals.</p></dd>


<dt>by</dt>
<dd><p>A factor of the same length for split of the plot by this factor (no split if omitted).
In the context of this package this factor may code for groups defined by the user from functional
annotation.</p></dd>

  
<dt>CI.col</dt>
<dd><p>The color to draw the confidence intervals (unique color) of a factor coding for the color.</p></dd>


<dt>CI.alpha</dt>
<dd><p>Optional transparency of the lines used to draw the confidence intervals.</p></dd>


<dt>add.point</dt>
<dd><p>If <code>TRUE</code> points are added to confidence intervals.</p></dd>


<dt>point.size</dt>
<dd><p>Size of the added points in case <code>add.point</code> is <code>TRUE</code>.</p></dd>


<dt>point.type</dt>
<dd><p>Shape of the added points in case <code>add.point</code> is <code>TRUE</code>
  defined as an integer coding for a unique common shape or
  as a factor coding for the shape.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
     

<p>a ggplot object.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="bmdboot.html">plot.bmdboot</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marie-Laure Delignette-Muller</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) a toy example (a very small subsample of a microarray data set) </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_very_small_sample.txt"</span>,</span></span>
<span class="r-in"><span>package<span class="op">=</span><span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-in"><span><span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing intercept from test coefficients</span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="drcfit.html">drcfit</a></span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitting may be long if the number of selected items is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdcalc.html">bmdcalc</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># to get reproducible results with a so small number of iterations</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdboot.html">bmdboot</a></span><span class="op">(</span><span class="va">r</span>, niter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># with a non reasonable value for niter </span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> A small number of iterations (less than 1000) may not be sufficient to</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> ensure a good quality of bootstrap confidence intervals.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The bootstrap may be long if the number of items and the number of </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrap iterations is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="co"># !!!! TO GET CORRECT RESULTS</span></span></span>
<span class="r-in"><span><span class="co"># !!!! niter SHOULD BE FIXED FAR LARGER , e.g. to 1000 </span></span></span>
<span class="r-in"><span><span class="co"># !!!! but the run will be longer </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># manual ecdf plot of the bootstrap results as an ecdf distribution </span></span></span>
<span class="r-in"><span><span class="co"># on BMD, plot that could also be obtained with plot(b) </span></span></span>
<span class="r-in"><span><span class="co"># in this simple case</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">$</span><span class="va">res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span><span class="op">$</span><span class="va">BMD.zSD.upper</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">ecdfplotwithCI</span><span class="op">(</span>variable <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD</span>, CI.lower <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.lower</span>, </span></span>
<span class="r-in"><span>              CI.upper <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.upper</span>, CI.col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ecdfplotwithCI-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (2) An example from data published by Larras et al. 2020</span></span></span>
<span class="r-in"><span><span class="co"># in Journal of Hazardous Materials</span></span></span>
<span class="r-in"><span><span class="co"># https://doi.org/10.1016/j.jhazmat.2020.122727</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This function can also be used to go deeper in the exploration of the biological </span></span></span>
<span class="r-in"><span><span class="co"># meaning of the responses. Here is an example linking the DRomics outputs </span></span></span>
<span class="r-in"><span><span class="co"># with the functional annotation of the responding metabolites of the microalgae </span></span></span>
<span class="r-in"><span><span class="co"># Scenedesmus vacuolatus to the biocide triclosan. </span></span></span>
<span class="r-in"><span><span class="co"># This extra step uses a dataframe previously built by the user which links the items</span></span></span>
<span class="r-in"><span><span class="co"># to the biological information of interest (e.g. KEGG pathways).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># importation of a dataframe with metabolomic results </span></span></span>
<span class="r-in"><span><span class="co"># (output $res of bmdcalc() or bmdboot() functions)</span></span></span>
<span class="r-in"><span><span class="va">resfilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"triclosanSVmetabres.txt"</span>, package<span class="op">=</span><span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">resfilename</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	31 obs. of  27 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ id              : Factor w/ 31 levels "NAP47_51","NAP_2",..: 2 3 4 5 6 7 8 9 10 11 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ irow            : int  2 21 28 34 38 47 49 51 53 67 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ adjpvalue       : num  6.23e-05 1.11e-05 1.03e-05 1.89e-03 4.16e-03 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model           : Factor w/ 4 levels "Gauss-probit",..: 2 3 3 2 2 4 2 2 3 3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ nbpar           : int  3 2 2 3 3 5 3 3 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ b               : num  0.4598 -0.0595 -0.0451 0.6011 0.6721 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ c               : num  NA NA NA NA NA ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ d               : num  5.94 5.39 7.86 6.86 6.21 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ e               : num  -1.648 NA NA -0.321 -0.323 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ f               : num  NA NA NA NA NA ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ SDres           : num  0.126 0.0793 0.052 0.2338 0.2897 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ typology        : Factor w/ 10 levels "E.dec.concave",..: 2 7 7 2 2 9 2 2 7 7 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ trend           : Factor w/ 4 levels "U","bell","dec",..: 3 3 3 3 3 1 3 3 3 3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ y0              : num  5.94 5.39 7.86 6.86 6.21 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ yrange          : num  0.456 0.461 0.35 0.601 0.672 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ maxychange      : num  0.456 0.461 0.35 0.601 0.672 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ xextrem         : num  NA NA NA NA NA ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ yextrem         : num  NA NA NA NA NA ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.zSD         : num  0.528 1.333 1.154 0.158 0.182 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMR.zSD         : num  5.82 5.31 7.81 6.62 5.92 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.xfold       : num  NA NA NA NA 0.832 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMR.xfold       : num  5.35 4.85 7.07 6.17 5.59 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.zSD.lower   : num  0.2001 0.8534 0.7519 0.0554 0.081 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.zSD.upper   : num  1.11 1.746 1.465 0.68 0.794 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.xfold.lower : num  Inf 7.611 Inf 0.561 0.329 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ BMD.xfold.upper : num  Inf Inf Inf Inf Inf ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ nboot.successful: int  957 1000 1000 648 620 872 909 565 1000 1000 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># importation of a dataframe with annotation of each item</span></span></span>
<span class="r-in"><span><span class="co"># identified in the previous file (this dataframe must be previously built by the user)</span></span></span>
<span class="r-in"><span><span class="co"># each item may have more than one annotation (-&gt; more than one line)</span></span></span>
<span class="r-in"><span><span class="va">annotfilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"triclosanSVmetabannot.txt"</span>, package<span class="op">=</span><span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">annotfilename</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	84 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ metab.code: Factor w/ 31 levels "NAP47_51","NAP_2",..: 2 3 4 4 4 4 5 6 7 8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ path_class: Factor w/ 9 levels "Amino acid metabolism",..: 5 3 3 2 6 8 5 5 5 5 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Merging of both previous dataframes</span></span></span>
<span class="r-in"><span><span class="co"># in order to obtain an extenderes dataframe</span></span></span>
<span class="r-in"><span><span class="co"># bootstrap results and annotation</span></span></span>
<span class="r-in"><span><span class="va">annotres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">res</span>, y <span class="op">=</span> <span class="va">annot</span>, by.x <span class="op">=</span> <span class="st">"id"</span>, by.y <span class="op">=</span> <span class="st">"metab.code"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">annotres</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         id irow    adjpvalue       model nbpar           b  c        d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 NAP47_51   46 7.158246e-04      linear     2 -0.05600559 NA 7.343571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    NAP_2    2 6.232579e-05 exponential     3  0.45981242 NA 5.941896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   NAP_23   21 1.106958e-05      linear     2 -0.05946618 NA 5.387252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   NAP_30   28 1.028343e-05      linear     2 -0.04507832 NA 7.859109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   NAP_30   28 1.028343e-05      linear     2 -0.04507832 NA 7.859109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   NAP_30   28 1.028343e-05      linear     2 -0.04507832 NA 7.859109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           e  f      SDres     typology trend       y0    yrange maxychange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        NA NA 0.12454183        L.dec   dec 7.343571 0.4346034  0.4346034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -1.647958 NA 0.12604568 E.dec.convex   dec 5.941896 0.4556672  0.4556672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        NA NA 0.07929266        L.dec   dec 5.387252 0.4614576  0.4614576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        NA NA 0.05203245        L.dec   dec 7.859109 0.3498078  0.3498078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        NA NA 0.05203245        L.dec   dec 7.859109 0.3498078  0.3498078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        NA NA 0.05203245        L.dec   dec 7.859109 0.3498078  0.3498078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   xextrem yextrem   BMD.zSD  BMR.zSD BMD.xfold BMR.xfold BMD.zSD.lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA      NA 2.2237393 7.219029        NA  6.609214     0.9785095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA      NA 0.5279668 5.815850        NA  5.347706     0.2000881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      NA      NA 1.3334076 5.307960        NA  4.848527     0.8533711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      NA      NA 1.1542677 7.807077        NA  7.073198     0.7518588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      NA      NA 1.1542677 7.807077        NA  7.073198     0.7518588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      NA      NA 1.1542677 7.807077        NA  7.073198     0.7518588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   BMD.zSD.upper BMD.xfold.lower BMD.xfold.upper nboot.successful</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      4.068699             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1.109559             Inf             Inf              957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1.746010        7.610936             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1.464998             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1.464998             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      1.464998             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    path_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                            Lipid metabolism</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                            Lipid metabolism</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                     Carbohydrate metabolism</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                     Carbohydrate metabolism</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Biosynthesis of other secondary metabolites</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                          Membrane transport</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### an ECDFplot with confidence intervals by pathway</span></span></span>
<span class="r-in"><span><span class="co"># with color coding for dose-response trend</span></span></span>
<span class="r-in"><span><span class="fu">ecdfplotwithCI</span><span class="op">(</span>variable <span class="op">=</span> <span class="va">annotres</span><span class="op">$</span><span class="va">BMD.zSD</span>, </span></span>
<span class="r-in"><span>               CI.lower <span class="op">=</span> <span class="va">annotres</span><span class="op">$</span><span class="va">BMD.zSD.lower</span>, </span></span>
<span class="r-in"><span>               CI.upper <span class="op">=</span> <span class="va">annotres</span><span class="op">$</span><span class="va">BMD.zSD.upper</span>, </span></span>
<span class="r-in"><span>               by <span class="op">=</span> <span class="va">annotres</span><span class="op">$</span><span class="va">path_class</span>,</span></span>
<span class="r-in"><span>               CI.col <span class="op">=</span> <span class="va">annotres</span><span class="op">$</span><span class="va">trend</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="ecdfplotwithCI-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) an example on a microarray data set (a subsample of a greater data set) </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_sample.txt"</span>, package<span class="op">=</span><span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elements of the experimental design in order to check the coding of the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tested doses and number of replicates for each dose:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0  0.69 1.223 2.148 3.774 6.631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5     5     5     5     5     5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of items: 1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "1"    "2"    "3"    "4"    "5.1"  "5.2"  "6.1"  "6.2"  "7.1"  "7.2" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "8.1"  "8.2"  "9.1"  "9.2"  "10.1" "10.2" "11.1" "11.2" "12.1" "12.2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data were normalized between arrays using the following method: cyclicloess </span>
<span class="r-in"><span><span class="op">(</span><span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing intercept from test coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of selected items using a quadratic trend test with an FDR of 0.001: 78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 most responsive items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "384.2" "383.1" "383.2" "384.1" "301.1" "363.1" "300.2" "364.2" "364.1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "363.2" "301.2" "300.1" "351.1" "350.2" "239.1" "240.1" "240.2" "370"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "15"    "350.1"</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="drcfit.html">drcfit</a></span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitting may be long if the number of selected items is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  29%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  79%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of the fitting using the AICc to select the best fit model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 dose-response curves out of 78 previously selected were removed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> because no model could be fitted reliably.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the chosen models among the 69 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Hill           linear      exponential     Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               11               30               23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the trends (curve shapes) among the 69 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    U bell  dec  inc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6   20   22   21 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdcalc.html">bmdcalc</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 BMD-xfold values and 0 BMD-zSD values are not defined (coded NaN as </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> the BMR stands outside the range of response values defined by the model).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 BMD-xfold values and 0 BMD-zSD values could not be calculated (coded </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA as the BMR stands within the range of response values defined by the </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model but outside the range of tested doses).</span>
<span class="r-in"><span><span class="op">(</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdboot.html">bmdboot</a></span><span class="op">(</span><span class="va">r</span>, niter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="co"># niter to put at 1000 for a better precision</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> A small number of iterations (less than 1000) may not be sufficient to</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> ensure a good quality of bootstrap confidence intervals.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The bootstrap may be long if the number of items and the number of </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrap iterations is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  35%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  52%  |                                                                              |======================================                                |  54%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  59%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  72%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  75%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=========================================================             |  81%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  93%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap confidence interval computation failed on 6 items among 69 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> due to lack of convergence of the model fit for a fraction of the </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrapped samples greater than 0.5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For 0 BMD.zSD values and 35 BMD.xfold values among 69 at least one </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bound of the 95 percent confidence interval could not be computed due </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> to some bootstrapped BMD values not reachable due to model asymptotes </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> or reached outside the range of tested doses (bounds coded Inf)).</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3.a) </span></span></span>
<span class="r-in"><span><span class="co"># manual ecdf plot of the bootstrap results as an ecdf distribution </span></span></span>
<span class="r-in"><span><span class="co"># on BMD for each trend</span></span></span>
<span class="r-in"><span><span class="co"># plot that could also be obtained with plot(b, by = "trend") </span></span></span>
<span class="r-in"><span><span class="co"># in this simple case</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">$</span><span class="va">res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span><span class="op">$</span><span class="va">BMD.zSD.upper</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">ecdfplotwithCI</span><span class="op">(</span>variable <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD</span>, CI.lower <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.lower</span>, </span></span>
<span class="r-in"><span>              CI.upper <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.upper</span>, by <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">trend</span>, CI.col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ecdfplotwithCI-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3.b)</span></span></span>
<span class="r-in"><span><span class="co"># ecdf plot of the bootstrap results as an ecdf distribution </span></span></span>
<span class="r-in"><span><span class="co"># on BMD for each model</span></span></span>
<span class="r-in"><span><span class="co"># with the color of the confidence intervals coding for the trend</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu">ecdfplotwithCI</span><span class="op">(</span>variable <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD</span>, CI.lower <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.lower</span>, </span></span>
<span class="r-in"><span>              CI.upper <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.upper</span>, by <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">model</span>, CI.col <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">trend</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ecdfplotwithCI-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># changing the size of the points and the transparency of CI lines</span></span></span>
<span class="r-in"><span><span class="fu">ecdfplotwithCI</span><span class="op">(</span>variable <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD</span>, CI.lower <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.lower</span>, </span></span>
<span class="r-in"><span>              CI.upper <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.upper</span>, by <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">model</span>, CI.col <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">trend</span>,</span></span>
<span class="r-in"><span>              CI.alpha <span class="op">=</span> <span class="fl">0.5</span>, point.size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ecdfplotwithCI-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># with the model coding for the type of points</span></span></span>
<span class="r-in"><span><span class="fu">ecdfplotwithCI</span><span class="op">(</span>variable <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD</span>, CI.lower <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.lower</span>, </span></span>
<span class="r-in"><span>              CI.upper <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.upper</span>, CI.col <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">trend</span>,</span></span>
<span class="r-in"><span>              CI.alpha <span class="op">=</span> <span class="fl">0.5</span>, point.size <span class="op">=</span> <span class="fl">0.5</span>, point.type <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ecdfplotwithCI-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3.c)</span></span></span>
<span class="r-in"><span><span class="co"># ecdf plot of the bootstrap results as an ecdf distribution on </span></span></span>
<span class="r-in"><span><span class="co"># on BMD_L (lower value of the confidence interval) for each trend</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="fu">ecdfplotwithCI</span><span class="op">(</span>variable <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.lower</span>, CI.lower <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.lower</span>, </span></span>
<span class="r-in"><span>              CI.upper <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">BMD.zSD.upper</span>, by <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">model</span>, CI.col <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">trend</span>, </span></span>
<span class="r-in"><span>              add.point <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ecdfplotwithCI-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marie-Laure Delignette-Muller, Elise Billoir, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

