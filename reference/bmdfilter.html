<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Filtering BMDs in DRomics workflow output according to estimation quality,
to retain the best estimated BMDs for subsequent biological annotation and interpretation."><title>Filtering BMDs according to estimation quality — bmdfilter • DRomics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filtering BMDs according to estimation quality — bmdfilter"><meta property="og:description" content="Filtering BMDs in DRomics workflow output according to estimation quality,
to retain the best estimated BMDs for subsequent biological annotation and interpretation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DRomics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.5-0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/DRomics_vignette.html">Overview of the DRomics package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aursiber/DRomics/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Filtering BMDs according to estimation quality</h1>
      
      <div class="d-none name"><code>bmdfilter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Filtering BMDs in DRomics workflow output according to estimation quality,
to retain the best estimated BMDs for subsequent biological annotation and interpretation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bmdfilter</span><span class="op">(</span><span class="va">res</span>, </span>
<span>              BMDfilter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"definedCI"</span>, <span class="st">"finiteCI"</span>, <span class="st">"definedBMD"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>              BMDtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"zSD"</span>, <span class="st">"xfold"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>res</dt>
<dd><p>The dataframe of results provided by 
 <code><a href="bmdboot.html">bmdboot</a></code> or <code><a href="bmdcalc.html">bmdcalc</a></code> (<code>res</code>) 
 or a subset of this data frame.</p> 
<p>Even if this function is intended to be used just after the calculation
 of BMD values, before the biological annotation, it can also be used
 within the interpretation workflow, on an extended dataframe
 with additional columns coming for example from the biological annotation of items, 
 and with some lines replicated for items with more than one annotation.</p> 
<p>In any case the dataframe
 must at least contain the column giving the BMD values (<code>BMD.zSD</code> or <code>BMD.xfold</code>
 depending on the chosen BMDtype), identification of each curve (<code>id</code>),
 and if <code>BMDfilter</code> is set to <code>"CIdefined"</code> or <code>"CIfinite"</code>,
 the columns <code>BMD.zSD.lower</code>, <code>BMD.zSD.upper</code> or
 <code>BMD.xfold.lower</code>, <code>BMD.xfold.upper</code> depending on the argument <code>BMDtype</code>.</p></dd>


<dt>BMDfilter</dt>
<dd><p>If not <code>"none"</code>, the type of filter applied, based on BMD estimation.
If <code>"definedCI"</code> (default choice), all items for which point and interval estimates
of the BMD were successfully calculated are retained 
(so items for which the bootstrap procedure failed are excluded). 
If <code>"finiteCI"</code>, all items for which point and interval estimates of the BMD 
were successfully calculated and gave values within the range of tested/observed doses are retained.
If <code>"definedBMD"</code>, all items for which the point estimate of the BMD 
was estimated at a value within the range of tested/observed doses are retained.</p></dd>


<dt>BMDtype</dt>
<dd><p>The type of BMD used for the previously
described filtering procedure, <code>"zSD"</code> (default choice) or <code>"xfold"</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Using the argument <code>BMDfilter</code> three filters are proposed to retain
only the items associated to the best estimated BMD values.
By default we recommend to retain only the items for which the BMD and its
confidence interval are defined (using <code>"CIdefined"</code>) 
(so excluding items for which the bootstrap procedure failed).
One can be even more restrictive by 
retaining items only if the BMD confidence interval is within the range of
tested/observed doses (using <code>"CIfinite"</code>), or less restrictive 
(using <code>"BMDIdefined"</code>) requiring that the BMD
point estimate only must be defined within the range of tested/observed doses 
(let us recall that in the <code><a href="bmdcalc.html">bmdcalc</a></code> output, 
if it is not the case the BMD is coded <code>NA</code>).</p>
<p>We propose an option <code>"none"</code> only in case, in the future, we add
other filters not based on the BMD.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
     

<p>A dataframe corresponding to a subset of res given in input, that 
   can be used for biological annotation and further exploration.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="selectgroups.html">selectgroups</a></code>, <code><a href="bmdboot.html">bmdboot</a></code> and 
    <code><a href="bmdcalc.html">bmdcalc</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marie-Laure Delignette-Muller</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) a toy example </span></span></span>
<span class="r-in"><span><span class="co"># on a very small subsample of a microarray data set</span></span></span>
<span class="r-in"><span><span class="co"># and a very smal number of bootstrap iterations </span></span></span>
<span class="r-in"><span><span class="co"># (clearly not sufficient, but it is just for illustration)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_very_small_sample.txt"</span>,</span></span>
<span class="r-in"><span>                            package <span class="op">=</span> <span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to test the package on a small but not very small data set</span></span></span>
<span class="r-in"><span><span class="co"># use the following commented line</span></span></span>
<span class="r-in"><span><span class="co"># datafilename &lt;- system.file("extdata", "transcripto_sample.txt", package = "DRomics")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-in"><span><span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing intercept from test coefficients</span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="drcfit.html">drcfit</a></span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitting may be long if the number of selected items is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |===                                                                   |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  14%  |                                                                              |=============                                                         |  19%  |                                                                              |=================                                                     |  24%  |                                                                              |====================                                                  |  29%  |                                                                              |=======================                                               |  33%  |                                                                              |===========================                                           |  38%  |                                                                              |==============================                                        |  43%  |                                                                              |=================================                                     |  48%  |                                                                              |=====================================                                 |  52%  |                                                                              |========================================                              |  57%  |                                                                              |===========================================                           |  62%  |                                                                              |===============================================                       |  67%  |                                                                              |==================================================                    |  71%  |                                                                              |=====================================================                 |  76%  |                                                                              |=========================================================             |  81%  |                                                                              |============================================================          |  86%  |                                                                              |===============================================================       |  90%  |                                                                              |===================================================================   |  95%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdcalc.html">bmdcalc</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span> <span class="co"># to get reproducible results with a so small number of iterations</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdboot.html">bmdboot</a></span><span class="op">(</span><span class="va">r</span>, niter <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="co"># with a non reasonable value for niter</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> A small number of iterations (less than 1000) may not be sufficient to</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> ensure a good quality of bootstrap confidence intervals.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The bootstrap may be long if the number of items and the number of </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrap iterations is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap confidence interval computation failed on 2 items among 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> due to lack of convergence of the model fit for a fraction of the </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrapped samples greater than 0.5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For 3 BMD.zSD values and 12 BMD.xfold values among 20 at least one </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bound of the 95 percent confidence interval could not be computed due </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> to some bootstrapped BMD values not reachable due to model asymptotes </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> or reached outside the range of tested doses (bounds coded Inf)).</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># !!!! TO GET CORRECT RESULTS</span></span></span>
<span class="r-in"><span><span class="co"># !!!! niter SHOULD BE FIXED FAR LARGER , e.g. to 1000 </span></span></span>
<span class="r-in"><span><span class="co"># !!!! but the run will be longer</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### (1.a) Examples on BMD.xfold (with some undefined BMD.xfold values)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of BMDs with no filtering</span></span></span>
<span class="r-in"><span><span class="va">subres</span> <span class="op">&lt;-</span> <span class="fu">bmdfilter</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span>, BMDfilter <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bmdplot.html">bmdplot</a></span><span class="op">(</span><span class="va">subres</span>, BMDtype <span class="op">=</span> <span class="st">"xfold"</span>, point.size <span class="op">=</span> <span class="fl">3</span>, add.CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 10 rows containing missing values (`geom_point()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values (`geom_errorbarh()`).</span>
<span class="r-plt img"><img src="bmdfilter-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of items with defined BMD point estimate</span></span></span>
<span class="r-in"><span><span class="va">subres</span> <span class="op">&lt;-</span> <span class="fu">bmdfilter</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span>, BMDtype <span class="op">=</span> <span class="st">"xfold"</span>, BMDfilter <span class="op">=</span> <span class="st">"definedBMD"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bmdplot.html">bmdplot</a></span><span class="op">(</span><span class="va">subres</span>, BMDtype <span class="op">=</span> <span class="st">"xfold"</span>, point.size <span class="op">=</span> <span class="fl">3</span>, add.CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 1 rows containing missing values (`geom_errorbarh()`).</span>
<span class="r-plt img"><img src="bmdfilter-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of items with defined BMD point estimate and CI bounds</span></span></span>
<span class="r-in"><span><span class="va">subres</span> <span class="op">&lt;-</span> <span class="fu">bmdfilter</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span>, BMDtype <span class="op">=</span> <span class="st">"xfold"</span>, BMDfilter <span class="op">=</span> <span class="st">"definedCI"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bmdplot.html">bmdplot</a></span><span class="op">(</span><span class="va">subres</span>, BMDtype <span class="op">=</span> <span class="st">"xfold"</span>, point.size <span class="op">=</span> <span class="fl">3</span>, add.CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bmdfilter-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of items with finite BMD point estimate and CI bounds</span></span></span>
<span class="r-in"><span><span class="va">subres</span> <span class="op">&lt;-</span> <span class="fu">bmdfilter</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span>, BMDtype <span class="op">=</span> <span class="st">"xfold"</span>, BMDfilter <span class="op">=</span> <span class="st">"finiteCI"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="bmdplot.html">bmdplot</a></span><span class="op">(</span><span class="va">subres</span>, BMDtype <span class="op">=</span> <span class="st">"xfold"</span>, point.size <span class="op">=</span> <span class="fl">3</span>, add.CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bmdfilter-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### (1.b) Examples on BMD.zSD (with no undefined BMD.zSD values)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of BMDs with no filtering</span></span></span>
<span class="r-in"><span><span class="va">subres</span> <span class="op">&lt;-</span> <span class="fu">bmdfilter</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span>, BMDfilter <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bmdplot.html">bmdplot</a></span><span class="op">(</span><span class="va">subres</span>, BMDtype <span class="op">=</span> <span class="st">"zSD"</span>, point.size <span class="op">=</span> <span class="fl">3</span>, add.CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values (`geom_errorbarh()`).</span>
<span class="r-plt img"><img src="bmdfilter-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot items with defined BMD point estimate (the same on this ex.)</span></span></span>
<span class="r-in"><span><span class="va">subres</span> <span class="op">&lt;-</span> <span class="fu">bmdfilter</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span>, BMDtype <span class="op">=</span> <span class="st">"zSD"</span>, BMDfilter <span class="op">=</span> <span class="st">"definedBMD"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bmdplot.html">bmdplot</a></span><span class="op">(</span><span class="va">subres</span>, BMDtype <span class="op">=</span> <span class="st">"zSD"</span>, point.size <span class="op">=</span> <span class="fl">3</span>, add.CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values (`geom_errorbarh()`).</span>
<span class="r-plt img"><img src="bmdfilter-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of items with defined BMD point estimate and CI bounds</span></span></span>
<span class="r-in"><span><span class="va">subres</span> <span class="op">&lt;-</span> <span class="fu">bmdfilter</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span>, BMDtype <span class="op">=</span> <span class="st">"zSD"</span>, BMDfilter <span class="op">=</span> <span class="st">"definedCI"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bmdplot.html">bmdplot</a></span><span class="op">(</span><span class="va">subres</span>, BMDtype <span class="op">=</span> <span class="st">"zSD"</span>, point.size <span class="op">=</span> <span class="fl">3</span>, add.CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bmdfilter-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of items with finite BMD point estimate and CI bounds</span></span></span>
<span class="r-in"><span><span class="va">subres</span> <span class="op">&lt;-</span> <span class="fu">bmdfilter</span><span class="op">(</span><span class="va">b</span><span class="op">$</span><span class="va">res</span>, BMDtype <span class="op">=</span> <span class="st">"zSD"</span>, BMDfilter <span class="op">=</span> <span class="st">"finiteCI"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="bmdplot.html">bmdplot</a></span><span class="op">(</span><span class="va">subres</span>, BMDtype <span class="op">=</span> <span class="st">"zSD"</span>, point.size <span class="op">=</span> <span class="fl">3</span>, add.CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bmdfilter-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marie-Laure Delignette-Muller, Elise Billoir, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

