<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Dose response modelling for responsive items — drcfit • DRomics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dose response modelling for responsive items — drcfit"><meta name="description" content="Fits dose reponse models to responsive items."><meta property="og:description" content="Fits dose reponse models to responsive items."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DRomics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.6-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DRomics_vignette.html">Overview of the DRomics package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbbe-software/DRomics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dose response modelling for responsive items</h1>

      <div class="d-none name"><code>drcfit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits dose reponse models to responsive items.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">drcfit</span><span class="op">(</span><span class="va">itemselect</span>, </span>
<span>  information.criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AICc"</span>, <span class="st">"BIC"</span>, <span class="st">"AIC"</span><span class="op">)</span>,</span>
<span>  deltaAICminfromnullmodel <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  postfitfilter <span class="op">=</span> <span class="cn">TRUE</span>, preventsfitsoutofrange <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  enablesfequal0inGP <span class="op">=</span> <span class="cn">TRUE</span>, enablesfequal0inLGP <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  progressbar <span class="op">=</span> <span class="cn">TRUE</span>, parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"snow"</span>, <span class="st">"multicore"</span><span class="op">)</span>, <span class="va">ncpus</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'drcfit'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'drcfit'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">items</span>, </span>
<span>  plot.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dose_fitted"</span>, <span class="st">"dose_residuals"</span>,<span class="st">"fitted_residuals"</span><span class="op">)</span>, </span>
<span>  dose_log_transfo <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">BMDoutput</span>, BMDtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"zSD"</span>, <span class="st">"xfold"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span>   </span>
<span><span class="fu">plotfit2pdf</span><span class="op">(</span><span class="va">x</span>, <span class="va">items</span>, </span>
<span>  plot.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dose_fitted"</span>, <span class="st">"dose_residuals"</span>, <span class="st">"fitted_residuals"</span><span class="op">)</span>, </span>
<span>  dose_log_transfo <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">BMDoutput</span>, BMDtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"zSD"</span>, <span class="st">"xfold"</span><span class="op">)</span>,</span>
<span>  nrowperpage <span class="op">=</span> <span class="fl">6</span>, ncolperpage <span class="op">=</span> <span class="fl">4</span>, path2figs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-itemselect">itemselect<a class="anchor" aria-label="anchor" href="#arg-itemselect"></a></dt>
<dd><p>An object of class <code>"itemselect"</code> returned by the function <code>itemselect</code>.</p></dd>


<dt id="arg-information-criterion">information.criterion<a class="anchor" aria-label="anchor" href="#arg-information-criterion"></a></dt>
<dd><p>The information criterion used to select the best fit model, <code>"AICc"</code> as recommended and default
  choice (the corrected version of the AIC that is recommended
  for small samples (see Burnham and Anderson 2004), <code>"BIC"</code> or <code>"AIC"</code>.</p></dd>


<dt id="arg-deltaaicminfromnullmodel">deltaAICminfromnullmodel<a class="anchor" aria-label="anchor" href="#arg-deltaaicminfromnullmodel"></a></dt>
<dd><p>The minimal difference on the chosen information
criterion (AICc, AIC or BIC) between the null model and the best fit model,
requested to accept the fit with the bestfit model.
It is by default fixed at 2 to keep only models which fit the data
clearly better than the null model, but it can be fixed at 0 to be less stringent.</p></dd>


<dt id="arg-postfitfilter">postfitfilter<a class="anchor" aria-label="anchor" href="#arg-postfitfilter"></a></dt>
<dd><p>If <code>TRUE</code> fits with significant trends on residuals
  (showing a global significant quadratic trend of the residuals
  as a function of the dose (in rank-scale)) are considered as failures and so eliminated.
  It is strongly recommended to let it at <code>TRUE</code>, its default value.</p></dd>


<dt id="arg-preventsfitsoutofrange">preventsfitsoutofrange<a class="anchor" aria-label="anchor" href="#arg-preventsfitsoutofrange"></a></dt>
<dd><p>If <code>TRUE</code> fits of Gaussian or log-Gaussian models
  that give an extremum value outside the range of the observed signal for an item
  are eliminated from the candidate models for this item,
  before the choice of the best.
  It is strongly recommended to let it at <code>TRUE</code>, its default value.</p></dd>


<dt id="arg-enablesfequal-ingp">enablesfequal0inGP<a class="anchor" aria-label="anchor" href="#arg-enablesfequal-ingp"></a></dt>
<dd><p>If <code>TRUE</code> when the fit of a Gauss-probit model with 5 parameters
  is successful, its simplified version with <code>f = 0</code> is also fitted and included in the candidate
  models. This submodel of the log-Gauss-probit model corresponds to the probit model.
  We recommend to let this argument at <code>TRUE</code>, its default value, in order to prevent
  overfitting, and prefer the description of a monotonic curve
  when the parameter f is not necessary to model the data according to the information criterion.</p></dd>


<dt id="arg-enablesfequal-inlgp">enablesfequal0inLGP<a class="anchor" aria-label="anchor" href="#arg-enablesfequal-inlgp"></a></dt>
<dd><p>If <code>TRUE</code> when the fit of a log-Gauss-probit model with 5 parameters
  is successful, its simplified version with <code>f = 0</code> is also fitted and included in the candidate
  models. This submodel of the log-Gauss-probit model corresponds to the log-probit model.
  We recommend to let this argument at <code>TRUE</code>, its default value, in order to prevent
  overfitting and prefer the description of a monotonic curve
  when the parameter f is not necessary to model the data according to the information criterion.</p></dd>


<dt id="arg-progressbar">progressbar<a class="anchor" aria-label="anchor" href="#arg-progressbar"></a></dt>
<dd><p>If <code>TRUE</code> a progress bar is used to follow the fitting process.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>The type of parallel operation to be used, <code>"snow"</code> or <code>"multicore"</code>
  (the second one not being available on Windows),
  or <code>"no"</code> if no parallel operation.</p></dd>


<dt id="arg-ncpus">ncpus<a class="anchor" aria-label="anchor" href="#arg-ncpus"></a></dt>
<dd><p>Number of processes to be used in parallel operation :
  typically one would fix it to the number of available CPUs.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>"drcfit"</code>.</p></dd>


<dt id="arg-items">items<a class="anchor" aria-label="anchor" href="#arg-items"></a></dt>
<dd><p>Argument of the <code>plot.drcfit</code> function : the number of the first fits to
  plot (20 items max) or the character vector
  specifying the identifiers of the items to plot (20 items max).</p></dd>


<dt id="arg-plot-type">plot.type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>The type of plot, by default <code>"dose_fitted"</code> for the plot of
  fitted curves with the observed points added to the plot and the observed means at each dose
  added as black plain circles, <code>"dose_residuals"</code> for the plot of the residuals as function
  of the dose, and <code>"fitted_residuals"</code> for the plot of the residuals as function of
  the fitted value.</p></dd>


<dt id="arg-dose-log-transfo">dose_log_transfo<a class="anchor" aria-label="anchor" href="#arg-dose-log-transfo"></a></dt>
<dd><p>By default at <code>TRUE</code> to use a log transformation
  for the dose axis (only used if the dose is in x-axis, so not
  for <code>plot.type</code> <code>"fitted_residuals"</code>).</p></dd>


<dt id="arg-bmdoutput">BMDoutput<a class="anchor" aria-label="anchor" href="#arg-bmdoutput"></a></dt>
<dd><p>Argument that can be used to add BMD values
  and optionally their confidence intervals on a plot of type <code>"dose_fitted"</code>.
  To do that you must previously apply <code><a href="bmdcalc.html">bmdcalc</a></code> and optionally
  <code><a href="bmdboot.html">bmdboot</a></code>
  on <code>x</code> of class <code>drcfit</code>
  and then give in this argument the output of <code><a href="bmdcalc.html">bmdcalc</a></code> or
  <code><a href="bmdboot.html">bmdboot</a></code>.</p></dd>


<dt id="arg-bmdtype">BMDtype<a class="anchor" aria-label="anchor" href="#arg-bmdtype"></a></dt>
<dd><p>The type of BMD to add on the plot, <code>"zSD"</code> (default choice) or   <code>"xfold"</code> (only used if BMDoutput is not missing).</p></dd>


<dt id="arg-nrowperpage">nrowperpage<a class="anchor" aria-label="anchor" href="#arg-nrowperpage"></a></dt>
<dd><p>Number of rows of plots when plots are saved in a pdf file using
  plotfit2pdf() (passed to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code>).</p></dd>


<dt id="arg-ncolperpage">ncolperpage<a class="anchor" aria-label="anchor" href="#arg-ncolperpage"></a></dt>
<dd><p>Number of columns of plots when plots are saved in a pdf file using
  plotfit2pdf() (passed to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code>).</p></dd>


<dt id="arg-path-figs">path2figs<a class="anchor" aria-label="anchor" href="#arg-path-figs"></a></dt>
<dd><p>File path when plots are saved in a pdf file using plotfit2pdf()</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to graphical or print functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each selected item, five dose-response models (linear, Hill, exponential,
Gauss-probit and log-Gauss-probit, see Larras et al. 2018
for their definition) are fitted by non linear regression,
using the <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></code> function. If a fit of a biphasic model gives a extremum
value out of the range of the observed signal, it is eliminated (this may happen in rare cases,
especially on observational data  when the number of samples is high and the dose in uncontrolled,
if doses are not distributed all along the dose range).
The best fit is chosen as the one giving the lowest AICc
(or BIC or AIC) value. The use of the AICc (second-order Akaike criterion)
instead of the AIC
is strongly recommended to prevent the overfitting that may occur with dose-response designs
with a small number of data points (Hurvich and Tsai, 1989; Burnham and Anderson DR, 2004).
Note that in the extremely rare cases where the number of
data points would be great, the AIC would converge to the AICc and both procedures would be equivalent.
Items with the best AICc value not lower than the AICc value of the null model (constant model) minus 2
are eliminated. Items with the best fit showing a global significant quadratic trend of the residuals
as a function of the dose (in rank-scale) are also eliminated (the best fit is considered as
not reliable in such cases).</p>
<p>Each retained item is classified in four classes by its global trend,
which can be used to roughly describe the shape of each dose-response curve:</p><ul><li><p>inc for increasing curves,</p></li>
<li><p>dec for decreasing curves ,</p></li>
<li><p>U for U-shape curves,</p></li>
<li><p>bell for bell-shape curves.</p></li>
</ul><p>Some curves fitted by a Gauss-probit model can be classified as increasing or decreasing when the
dose value at which their extremum is reached is at zero or if their simplified version with <code>f = 0</code>
is retained (corresponding to the probit model).
Some curves fitted by a log-Gauss-probit model can be classified as increasing or decreasing
if their simplified version with <code>f = 0</code>
is retained (corresponding to the log-probit model).</p>
<p>Each retained item is thus classified in a 16 class typology depending of the
chosen model and of its parameter values :</p><ul><li><p>H.inc for increasing Hill curves,</p></li>
<li><p>H.dec for decreasing Hill curves,</p></li>
<li><p>L.inc for increasing linear curves,</p></li>
<li><p>L.dec for decreasing linear curves,</p></li>
<li><p>E.inc.convex for increasing convex exponential curves,</p></li>
<li><p>E.dec.concave for decreasing concave exponential curves,</p></li>
<li><p>E.inc.concave for increasing concave exponential curves,</p></li>
<li><p>E.dec.convex for decreasing convex exponential curves,</p></li>
<li><p>GP.U for U-shape Gauss-probit curves,</p></li>
<li><p>GP.bell for bell-shape Gauss-probit curves,</p></li>
<li><p>GP.inc for increasing Gauss-probit curves,</p></li>
<li><p>GP.dec for decreasing Gauss-probit curves,</p></li>
<li><p>lGP.U for U-shape log-Gauss-probit curves,</p></li>
<li><p>lGP.bell for bell-shape log-Gauss-probit curves.</p></li>
<li><p>lGP.inc for increasing log-Gauss-probit curves,</p></li>
<li><p>lGP.dec for decreasing log-Gauss-probit curves,</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>drcfit</code> returns an object of class <code>"drcfit"</code>, a list with 4 components:</p>
<p></p>
<dl><dt>fitres</dt>
<dd><p>a data frame reporting the results of the fit on each selected item
   for which a successful fit is reached (one line per item) sorted in the ascending order of the adjusted p-values returned by function <code>itemselect</code>. The different columns correspond to the identifier of each item (<code>id</code>), the row number of this item in the initial data set (<code>irow</code>), the adjusted p-value of the selection step (<code>adjpvalue</code>), the name of the best fit model (<code>model</code>), the number of fitted parameters (<code>nbpar</code>), the values of the parameters <code>b</code>, <code>c</code>, <code>d</code>, <code>e</code> and <code>f</code>, (<code>NA</code> for non used parameters), the residual standard deviation (<code>SDres</code>), the typology of the curve (<code>typology</code>), the
   rough trend of the curve (<code>trend</code>) defined with four classes (U, bell, increasing or decreasing shape), the
   theoretical y value at the control <code>y0</code>), the
   theoretical y value at the maximal dose <code>yatdosemax</code>), the theoretical y range for x within the range of
   tested doses (<code>yrange</code>), the maximal absolute y change (up or down) from the control(<code>maxychange</code>)
   and for biphasic curves
   the x value at which their extremum is reached (<code>xextrem</code>)
   and the corresponding y value (<code>yextrem</code>).</p></dd>


<dt>omicdata</dt>
<dd><p>The object containing all the data, as given in input of <code><a href="itemselect.html">itemselect()</a></code>
which is also a component of the output of <code><a href="itemselect.html">itemselect()</a></code>.</p></dd>


<dt>information.criterion</dt>
<dd><p>The information criterion used to select the best fit model as given in input.</p></dd>


<dt>information.criterion.val</dt>
<dd><p>A data frame reporting the IC values (AICc, BIC or AIC) values for each selected item (one line per item) and each fitted model (one colum per model with the IC value fixed at <code>Inf</code> when the fit failed).</p></dd>


<dt>n.failure</dt>
<dd><p>The number of previously selected items on which the workflow failed to fit an acceptable model.</p></dd>


<dt>unfitres</dt>
<dd><p>A data frame reporting the results on each selected item
for which no successful fit is reached (one line per item) sorted in the ascending order of the adjusted p-values returned by function <code>itemselect</code>. The different columns correspond to the identifier of each item (<code>id</code>), the row number of this item in the initial data set (<code>irow</code>), the adjusted p-value of the selection step (<code>adjpvalue</code>), and code for the reason of the fitting failure (<code>cause</code>, equal to <code>"constant.model"</code> if the best fit model is a constant model or <code>"trend.in.residuals"</code> if the best fit model is rejected due to quadratic trend on residuals.)</p></dd>


<dt>residualtests</dt>
<dd><p>A data frame of P-values of the tests performed on residuals,
on the mean trend (<code>resimeantrendP</code> ) and on the variance trend (<code>resivartrendP</code>). The first one tests a global significant quadratic trend of the residuals as a function of the dose in rank-scale (used to
eliminate unreliable fits) and the second one a global significant quadratic trend of the residuals in absolute value as a function of the dose in rank-scale
(used to alert in case of heteroscedasticity).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></code> for details about the non linear regression function and
  <code><a href="targetplot.html">targetplot</a></code> to plot target items (even if non responsive or unfitted).</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Burnham, KP, Anderson DR (2004). Multimodel inference: understanding AIC and BIC in model selection. Sociological methods &amp; research, 33(2), 261-304.</p>
<p>Hurvich, CM, Tsai, CL (1989). Regression and time series model selection in small samples. Biometrika, 76(2), 297-307.</p>
<p>Larras F, Billoir E, Baillard V, Siberchicot A, Scholz S, Wubet T, Tarkka M,
Schmitt-Jansen M and Delignette-Muller ML (2018). DRomics: a turnkey tool to support the use of the dose-response framework for omics data in ecological risk assessment. Environmental science &amp; technology.<a href="https://doi.org/10.1021/acs.est.8b04752" class="external-link">doi:10.1021/acs.est.8b04752</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marie-Laure Delignette-Muller</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) a toy example (a very small subsample of a microarray data set) </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_very_small_sample.txt"</span>, package <span class="op">=</span> <span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to test the package on a small (for a quick calculation) but not very small data set</span></span></span>
<span class="r-in"><span><span class="co"># use the following commented line</span></span></span>
<span class="r-in"><span><span class="co"># datafilename &lt;- system.file("extdata", "transcripto_sample.txt", package = "DRomics")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-in"><span><span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing intercept from test coefficients</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">drcfit</span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitting may be long if the number of selected items is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |===                                                                   |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  14%  |                                                                              |=============                                                         |  19%  |                                                                              |=================                                                     |  24%  |                                                                              |====================                                                  |  29%  |                                                                              |=======================                                               |  33%  |                                                                              |===========================                                           |  38%  |                                                                              |==============================                                        |  43%  |                                                                              |=================================                                     |  48%  |                                                                              |=====================================                                 |  52%  |                                                                              |========================================                              |  57%  |                                                                              |===========================================                           |  62%  |                                                                              |===============================================                       |  67%  |                                                                              |==================================================                    |  71%  |                                                                              |=====================================================                 |  76%  |                                                                              |=========================================================             |  81%  |                                                                              |============================================================          |  86%  |                                                                              |===============================================================       |  90%  |                                                                              |===================================================================   |  95%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of the fitting using the AICc to select the best fit model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 dose-response curves out of 21 previously selected were removed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> because no model could be fitted reliably.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the chosen models among the 20 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Hill           linear      exponential     Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                0                6                6                7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the trends (curve shapes) among the 20 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    U bell  dec  inc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4    4    6    6 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-plt img"><img src="drcfit-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># The same plot without log transformation of the doses </span></span></span>
<span class="r-in"><span><span class="co"># (in raw scale of doses)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span>, dose_log_transfo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="drcfit-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same plot in x log scale choosing x limits for plot</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span>, dose_log_transfo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-plt img"><img src="drcfit-3.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">x</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-plt img"><img src="drcfit-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of residuals as function of the dose</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span>, plot.type <span class="op">=</span> <span class="st">"dose_residuals"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-plt img"><img src="drcfit-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same plot of residuals without log transformation of the doses</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span>, plot.type <span class="op">=</span> <span class="st">"dose_residuals"</span>, dose_log_transfo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="drcfit-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot of residuals as function of the fitted value</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span>, plot.type <span class="op">=</span> <span class="st">"fitted_residuals"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="drcfit-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (2) an example on a microarray data set (a subsample of a greater data set) </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_sample.txt"</span>, package <span class="op">=</span> <span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elements of the experimental design in order to check the coding of the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tested doses and number of replicates for each dose:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0  0.69 1.223 2.148 3.774 6.631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5     5     5     5     5     5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of items: 1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "1"    "2"    "3"    "4"    "5.1"  "5.2"  "6.1"  "6.2"  "7.1"  "7.2" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "8.1"  "8.2"  "9.1"  "9.2"  "10.1" "10.2" "11.1" "11.2" "12.1" "12.2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data were normalized between arrays using the following method: cyclicloess </span>
<span class="r-in"><span><span class="op">(</span><span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing intercept from test coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of selected items using a quadratic trend test with an FDR of 0.05: 318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 most responsive items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "384.2" "383.1" "383.2" "384.1" "301.1" "363.1" "300.2" "364.2" "364.1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "363.2" "301.2" "300.1" "351.1" "350.2" "239.1" "240.1" "240.2" "370"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "15"    "350.1"</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">drcfit</span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitting may be long if the number of selected items is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of the fitting using the AICc to select the best fit model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60 dose-response curves out of 318 previously selected were removed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> because no model could be fitted reliably.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the chosen models among the 258 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Hill           linear      exponential     Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               85               64               89 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the trends (curve shapes) among the 258 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    U bell  dec  inc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   55   52   58   93 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-plt img"><img src="drcfit-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># save all plots to pdf using plotfit2pdf()</span></span></span>
<span class="r-in"><span><span class="fu">plotfit2pdf</span><span class="op">(</span><span class="va">f</span>, path2figs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Figures are stored in /tmp/RtmpMko7Wf.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pdf </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2 </span>
<span class="r-in"><span><span class="fu">plotfit2pdf</span><span class="op">(</span><span class="va">f</span>, plot.type <span class="op">=</span> <span class="st">"fitted_residuals"</span>, </span></span>
<span class="r-in"><span>  nrowperpage <span class="op">=</span> <span class="fl">9</span>, ncolperpage <span class="op">=</span> <span class="fl">6</span>, path2figs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Figures are stored in /tmp/RtmpMko7Wf.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pdf </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of the fit of the first 12 most responsive items</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span>, items <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-plt img"><img src="drcfit-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of the chosen items in the chosen order</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span>, items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"301.2"</span>, <span class="st">"363.1"</span>, <span class="st">"383.1"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BB00;">log-10</span> transformation introduced infinite values.</span>
<span class="r-plt img"><img src="drcfit-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Look at the table of results for successful fits</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">fitres</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      id irow    adjpvalue        model nbpar           b         c         d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 384.2  727 2.519524e-07 Gauss-probit     4  8.39021007  6.160174  6.160174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 383.1  724 6.558388e-07 Gauss-probit     4  3.81611448 10.480252 10.480252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 383.2  725 8.234946e-07 Gauss-probit     4  6.27817663  8.505693  8.505693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 384.1  726 2.804671e-06 Gauss-probit     4  8.59581518  5.684089  5.684089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 301.1  569 6.932747e-06  exponential     3  2.02444957        NA 12.846110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 363.1  686 7.084800e-06  exponential     3 -0.06029708        NA  9.026630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           e        f     SDres      typology trend       y0 yatdosemax</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1.538640 6.077561 0.1126233       GP.bell  bell 12.13639  11.215361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1.833579 1.861385 0.1411563       GP.bell  bell 12.13871  11.324854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1.751051 3.683404 0.1335847       GP.bell  bell 12.04858  11.228734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1.874867 6.568752 0.1379656       GP.bell  bell 12.09844  11.320509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -1.404111       NA 0.4905313  E.dec.convex   dec 12.84611  10.839662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2.064800       NA 0.2526946 E.dec.concave   dec  9.02663   7.590655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      yrange maxychange  xextrem  yextrem</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.0223735  0.9210335 1.538640 12.23774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.0167830  0.8138568 1.833579 12.34164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.9603629  0.8198451 1.751051 12.18910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.9323327  0.7779265 1.874867 12.25284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2.0064474  2.0064474       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1.4359752  1.4359752       NA       NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Look at the table of results for unsuccessful fits</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">unfitres</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       id irow    adjpvalue              cause</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 368.1  696 5.865601e-05 trend.in.residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 367.1  694 2.748644e-04 trend.in.residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51 360.2  681 3.964071e-04 trend.in.residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57 162.2  305 4.818750e-04 trend.in.residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59 161.1  302 5.387711e-04 trend.in.residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60 275.1  519 5.387711e-04 trend.in.residuals</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># count the number of unsuccessful fits for each cause</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">unfitres</span><span class="op">$</span><span class="va">cause</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     constant.model trend.in.residuals </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 30                 30 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) Comparison of parallel and non paralell implementations on a larger selection of items</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"parallel"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu">drcfit</span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">drcfit</span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">FALSE</span>, parallel <span class="op">=</span> <span class="st">"snow"</span>, ncpus <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marie-Laure Delignette-Muller, Elise Billoir, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

