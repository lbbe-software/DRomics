<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Performs and plots the results of a PCA on omic data — PCAdataplot • DRomics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Performs and plots the results of a PCA on omic data — PCAdataplot"><meta name="description" content="Provides a two dimensional plot (two first components) of a principal
component analysis (PCA) performed on omic data after normalization
and/or transformation, to check the promiximity of samples exposed
to the same dose and optionally the presence/absence of
a potential batch effect."><meta property="og:description" content="Provides a two dimensional plot (two first components) of a principal
component analysis (PCA) performed on omic data after normalization
and/or transformation, to check the promiximity of samples exposed
to the same dose and optionally the presence/absence of
a potential batch effect."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DRomics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.6-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DRomics_vignette.html">Overview of the DRomics package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lbbe-software/DRomics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Performs and plots the results of a PCA on omic data</h1>

      <div class="d-none name"><code>PCAdataplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides a two dimensional plot (two first components) of a principal
component analysis (PCA) performed on omic data after normalization
and/or transformation, to check the promiximity of samples exposed
to the same dose and optionally the presence/absence of
a potential batch effect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PCAdataplot</span><span class="op">(</span><span class="va">omicdata</span>, <span class="va">batch</span>, <span class="va">label</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-omicdata">omicdata<a class="anchor" aria-label="anchor" href="#arg-omicdata"></a></dt>
<dd><p>An object of class <code>"microarraydata"</code>, <code>"RNAseqdata"</code> or
<code>"continuousomicdata"</code> respectively returned by
functions <code>microarraydata</code>, <code>RNAseqdata</code> or
<code>continuousomicdata</code>.</p></dd>


<dt id="arg-batch">batch<a class="anchor" aria-label="anchor" href="#arg-batch"></a></dt>
<dd><p>Optionnally a factor coding for a potential batch effect
(factor of length the number of samples in the dataset).</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>Could be FALSE (default choice), TRUE or a character vector defining
the sample names. In the two last cases, the points are replaced
by labels of samples (so the batch
cannot be identified by the shape of points, but may appear in the sample names.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a ggplot object.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marie-Laure Delignette-Muller</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (1) on a microarray dataset</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_very_small_sample.txt"</span>, </span></span>
<span class="r-in"><span>  package<span class="op">=</span><span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elements of the experimental design in order to check the coding of the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tested doses and number of replicates for each dose:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0  0.69 1.223 2.148 3.774 6.631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5     5     5     5     5     5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of items: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "1"    "2"    "3"    "4"    "5.1"  "6.1"  "7.1"  "8.1"  "9.1"  "10.1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "11.1" "12.1" "13.1" "14.1" "15"   "16.1" "17.1" "18.1" "19.1" "20.1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data were normalized between arrays using the following method: cyclicloess </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PCAdataplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">PCAdataplot</span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PCAdataplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">PCAdataplot</span><span class="op">(</span><span class="va">o</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PCAdataplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">samplenames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">o</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">PCAdataplot</span><span class="op">(</span><span class="va">o</span>, label <span class="op">=</span> <span class="va">samplenames</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PCAdataplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># (2) an example on an RNAseq dataset with a potential batch effect </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">zebraf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">zebraf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ counts: int [1:1000, 1:16] 453 331 897 12 326 533 1948 904 583 154 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:1000] "ENSDARG00000102141" "ENSDARG00000102123" "ENSDARG00000114503" "ENSDARG00000115971" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:16] "I10_05mG_E5" "I10_05mG_E6" "I10_05mG_E7" "I10_C5" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dose  : num [1:16] 500 500 500 0 0 0 0 50000 50000 50000 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ batch : Factor w/ 2 levels "I10","I17": 1 1 1 1 1 1 1 2 2 2 ...</span>
<span class="r-in"><span><span class="va">data4DRomics</span> <span class="op">&lt;-</span> <span class="fu"><a href="formatdata4DRomics.html">formatdata4DRomics</a></span><span class="op">(</span>signalmatrix <span class="op">=</span> <span class="va">zebraf</span><span class="op">$</span><span class="va">counts</span>, </span></span>
<span class="r-in"><span>                           dose <span class="op">=</span> <span class="va">zebraf</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="RNAseqdata.html">RNAseqdata</a></span><span class="op">(</span><span class="va">data4DRomics</span>, transfo.method <span class="op">=</span> <span class="st">"vst"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> converting counts to integer mode</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> converting counts to integer mode</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> To optimize the dose-response modelling, it is recommended to use a</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> dose-response design with at least six different tested doses.</span>
<span class="r-in"><span><span class="fu">PCAdataplot</span><span class="op">(</span><span class="va">o</span>, batch <span class="op">=</span> <span class="va">zebraf</span><span class="op">$</span><span class="va">batch</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PCAdataplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">PCAdataplot</span><span class="op">(</span><span class="va">o</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PCAdataplot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marie-Laure Delignette-Muller, Elise Billoir, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

